<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2026 è®¸æ„¿æ¼‚æµç“¶ - å¯„å¾€æœªæ¥çš„ä¿¡</title>
    <style>
        /* ================= 1. è§†è§‰ç³»ç»Ÿï¼šæ˜Ÿè¾°å¤§æµ· ================= */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap');

        :root {
            --bg-color: #0f172a;
            --bg-gradient: radial-gradient(circle at 50% 0%, #1e293b 0%, #0f172a 100%);
            --glass-bg: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.15);
            --primary: #a5b4fc;
            --accent: #f43f5e;
            --text-light: #f8fafc;
            --gold: #fbbf24;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        body {
            font-family: 'Noto Serif SC', serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: var(--text-light);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }

        /* æ˜Ÿæ˜ŸèƒŒæ™¯ç‰¹æ•ˆ */
        body::before {
            content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                radial-gradient(white 1px, transparent 1px),
                radial-gradient(white 1.5px, transparent 1.5px);
            background-size: 50px 50px, 100px 100px;
            background-position: 0 0, 25px 25px;
            opacity: 0.2; pointer-events: none; z-index: -1;
        }

        .container { width: 100%; max-width: 420px; position: relative; z-index: 10; }
        .hidden { display: none !important; }

        /* ================= 2. ç»ç’ƒæ‹Ÿæ€å¡ç‰‡ ================= */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 30px 25px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            animation: fadeIn 0.8s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* ================= 3. è®¸æ„¿é¡µ ================= */
        .bottle-icon { 
            font-size: 80px; text-align: center; display: block; margin-bottom: 20px;
            filter: drop-shadow(0 0 15px rgba(255,255,255,0.4));
            animation: float 4s ease-in-out infinite; 
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        .title-main {
            font-size: 24px; font-weight: 700; text-align: center; margin-bottom: 8px;
            background: linear-gradient(to right, #fff, #a5b4fc);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .subtitle { text-align: center; font-size: 14px; color: rgba(255,255,255,0.6); margin-bottom: 30px; }

        .wish-textarea {
            width: 100%; height: 140px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 16px;
            padding: 20px;
            color: #fff; font-size: 16px; line-height: 1.6;
            resize: none; transition: all 0.3s;
        }
        .wish-textarea:focus { background: rgba(0, 0, 0, 0.5); border-color: var(--primary); }
        .wish-textarea::placeholder { color: rgba(255,255,255,0.3); font-style: italic; }

        .btn-glow {
            width: 100%; padding: 16px; margin-top: 25px;
            border-radius: 50px; border: none;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white; font-size: 18px; font-weight: bold; cursor: pointer;
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);
            position: relative; overflow: hidden;
        }
        .btn-glow::after {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 3s infinite;
        }
        @keyframes shine { 100% { left: 100%; } }

        /* ================= 4. åŠ¨ç”»é¡µ ================= */
        .throwing-scene { text-align: center; padding-top: 60px; }
        .bottle-fly { font-size: 60px; display: inline-block; animation: flyAway 3s forwards; }
        @keyframes flyAway {
            0% { transform: scale(1) translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: scale(0.1) translateY(-100px) rotate(360deg); opacity: 0; }
        }
        .loading-text { margin-top: 20px; color: var(--primary); font-size: 14px; animation: pulse 1.5s infinite; }

        /* ================= 5. ç»“æœé¡µ (ä¿¡çº¸é£) ================= */
        .paper-scroll {
            background: #fffdf5; color: #3e3e3e;
            padding: 25px 20px; border-radius: 4px;
            box-shadow: 0 0 0 5px rgba(255,255,255,0.1);
            position: relative; margin-bottom: 25px;
            transform: rotate(-1deg);
        }
        .paper-header { 
            border-bottom: 2px solid #3e3e3e; padding-bottom: 5px; margin-bottom: 15px; 
            display: flex; justify-content: space-between; font-size: 12px; font-weight: bold; color: #888;
        }
        .handwritten { font-size: 16px; line-height: 1.8; text-align: justify; }
        .stamp {
            position: absolute; bottom: 15px; right: 15px;
            width: 80px; height: 80px; border: 3px solid #d32f2f; border-radius: 50%;
            color: #d32f2f; display: flex; align-items: center; justify-content: center;
            font-weight: bold; transform: rotate(-15deg); opacity: 0.6; pointer-events: none;
        }

        .prob-box { text-align: center; margin: 20px 0; }
        .prob-val { font-size: 56px; font-weight: 900; color: var(--gold); text-shadow: 0 0 20px rgba(251, 191, 36, 0.4); }

        /* æ¨¡ç³Šé”å®š */
        .lock-container {
            background: rgba(0,0,0,0.3); border: 1px dashed rgba(255,255,255,0.3);
            border-radius: 12px; padding: 20px; position: relative; overflow: hidden;
        }
        .blur-content { filter: blur(6px); opacity: 0.5; user-select: none; }
        .lock-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 5;
        }
        .unlock-btn {
            background: linear-gradient(135deg, #f43f5e, #e11d48);
            color: white; border: none; padding: 10px 25px; border-radius: 30px;
            font-weight: bold; box-shadow: 0 4px 15px rgba(244, 63, 94, 0.4);
            cursor: pointer; animation: pulse 2s infinite;
        }

        /* ================= 6. æ”¯ä»˜é¡µ (å®Œç¾å¤åˆ»å›¾5) ================= */
        .pay-panel { 
            background: #fff; 
            border-radius: 20px; 
            padding: 30px 20px; 
            text-align: center; 
            color: #333; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .pay-title {
            font-size: 22px;
            color: #333;
            font-family: serif;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .pay-price {
            font-size: 46px;
            color: #ff4757;
            font-weight: bold;
            margin-bottom: 5px;
            font-family: sans-serif;
        }
        .pay-old-price {
            color: #aaa;
            font-size: 13px;
            text-decoration: line-through;
            margin-bottom: 25px;
        }
        
        .qr-row {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }
        .qr-card {
            width: 120px;
            text-align: center;
            position: relative;
        }
        .qr-header-wx {
            background: #2ecc71;
            color: white;
            font-size: 11px;
            padding: 4px;
            border-radius: 6px 6px 0 0;
            font-weight: bold;
        }
        .qr-header-ali {
            background: #3498db;
            color: white;
            font-size: 11px;
            padding: 4px;
            border-radius: 6px 6px 0 0;
            font-weight: bold;
        }
        .qr-img-box {
            border: 1px solid #eee;
            border-top: none;
            border-radius: 0 0 6px 6px;
            padding: 5px;
            background: #fff;
        }
        .qr-img-box img {
            width: 100%;
            display: block;
        }
        .qr-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        
        .copy-area {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: left;
        }
        .copy-title {
            font-size: 12px;
            color: #666;
            margin-bottom: 10px;
        }
        .copy-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            margin-bottom: 8px;
            color: #555;
        }
        .copy-item:last-child { margin-bottom: 0; }
        .copy-link {
            color: #ff4757;
            font-weight: bold;
            text-decoration: none;
            cursor: pointer;
            border-bottom: 1px solid rgba(255, 71, 87, 0.3);
        }
        .copy-link.blue { 
            color: #3498db; 
            border-bottom-color: rgba(52, 152, 219, 0.3); 
        }

        .btn-upload {
            background: #2f4f4f; /* æ·±å¢¨ç»¿ */
            color: white;
            width: 100%;
            padding: 16px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(47, 79, 79, 0.3);
            transition: transform 0.1s;
        }
        .btn-upload:active { transform: scale(0.98); }
        
        /* åº•éƒ¨æ‹›å‹Ÿæ¡† (è™šçº¿) */
        .footer-recruit-box {
            border: 1px dashed rgba(255,255,255,0.3);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            margin-top: 30px;
            color: rgba(255,255,255,0.8);
            font-size: 13px;
        }
        .recruit-icon { margin-right: 5px; }
        .recruit-link {
            color: #fff;
            text-decoration: underline;
            cursor: pointer;
            margin-top: 5px;
            display: inline-block;
        }

        /* ================= 7. å®Œæ•´ç»“æœé¡µ ================= */
        .final-card {
            background: #fff;
            border-radius: 16px;
            border: 2px solid #f3e5c9; /* æµ…é‡‘è¾¹æ¡† */
            padding: 30px 20px;
            position: relative;
            margin-bottom: 25px;
        }
        .final-card::before {
            content: 'â€œ';
            position: absolute;
            top: -10px; left: 20px;
            font-size: 60px; color: #f3e5c9; background: #fff;
            height: 30px; line-height: 40px; font-family: serif; padding: 0 10px;
        }
        
        .result-section { margin-bottom: 25px; }
        .res-title {
            color: #f43f5e; font-weight: bold; font-size: 16px; margin-bottom: 8px;
            display: flex; align-items: center; gap: 6px;
        }
        .res-content { font-size: 15px; line-height: 1.7; color: #333; text-align: justify; }

        @keyframes pulse { 0%{transform:scale(1)} 50%{transform:scale(1.05)} }
    </style>
</head>
<body>

<div class="container">

    <div id="page1" class="glass-card">
        <div class="bottle-icon">ğŸ¾</div>
        <h1 class="title-main">2026 è®¸æ„¿æ¼‚æµç“¶</h1>
        <p class="subtitle">åœ¨è¿™ä¸ªç“¶å­é‡Œï¼Œå†™ä¸‹ä½ å¯¹2026å¹´çš„ä¸€ä¸ªæ‰§å¿µ</p>
        
        <textarea id="userWish" class="wish-textarea" placeholder="ä¾‹å¦‚ï¼š
å¸Œæœ›2026å¹´å­˜æ¬¾è¾¾åˆ°50ä¸‡...
å¸Œæœ›èƒ½åœ¨ä»Šå¹´é‡è§æ­£ç¼˜...
å¸Œæœ›å®¶äººèº«ä½“å¥åº·..."></textarea>
        
        <button class="btn-glow" onclick="throwBottle()">
            ğŸŒŠ å¯†å°å¹¶æŠ›å…¥æ—¶é—´ä¹‹æµ·
        </button>
        <p style="text-align:center; font-size:12px; opacity:0.5; margin-top:15px;">å·²æœ‰ 23,041 ä¸ªæ„¿æœ›æ­£åœ¨æ¼‚æµ</p>
    </div>

    <div id="page2" class="hidden throwing-scene">
        <div class="bottle-fly">ğŸ¾</div>
        <div class="loading-text">
            æ­£åœ¨ç©¿è¶Š 2025 çš„æ—¶é—´è¿·é›¾...<br>
            <span style="font-size:12px; opacity:0.7;">æ­£åœ¨è¿æ¥å®‡å®™èƒ½é‡åœº</span>
        </div>
    </div>

    <div id="page3" class="hidden">
        <div class="glass-card" style="padding-top:10px;">
            <div style="text-align:center; margin-bottom:15px;">
                <span style="background:rgba(255,255,255,0.15); font-size:12px; padding:4px 12px; border-radius:12px;">âœ¨ æ”¶åˆ°ä¸€å°æ¥è‡ªæœªæ¥çš„å›ä¿¡</span>
            </div>

            <div class="paper-scroll">
                <div class="paper-header">
                    <span>TO: è®¸æ„¿äºº</span>
                    <span>FROM: 2026.12.31</span>
                </div>
                <div id="aiResponseText" class="handwritten"></div>
                <div class="stamp">å®‡å®™<br>å›å“</div>
            </div>

            <div class="prob-box">
                <div style="font-size:14px; opacity:0.8;">æ„¿æœ›åœ†æ¢¦æ¦‚ç‡</div>
                <div class="prob-val" id="probVal">92%</div>
            </div>

            <div class="lock-container">
                <div class="blur-content">
                    <p><strong>ğŸ—“ï¸ å…³é”®è½¬æŠ˜ç‚¹ï¼š</strong>2026å¹´6æœˆï¼Œä½ ä¼šé‡åˆ°...</p>
                    <p><strong>ğŸš§ æœ€å¤§é˜»ç¢ï¼š</strong>æƒ…ç»ªå†…è€—å¯èƒ½ä¼š...</p>
                    <p><strong>ğŸš€ è¡ŒåŠ¨æŒ‡å—ï¼š</strong>åšæŒåšè¿™ä¸€ä»¶äº‹...</p>
                </div>
                <div class="lock-overlay">
                    <div style="font-size:24px; margin-bottom:5px;">ğŸ”’</div>
                    <div style="font-size:14px; margin-bottom:10px; font-weight:bold;">è§£é”å®Œæ•´ã€Šåœ†æ¢¦æŒ‡å¼•ã€‹</div>
                    <button class="unlock-btn" onclick="goToPay()">ç«‹å³æŸ¥çœ‹ (Â¥2.99)</button>
                </div>
            </div>
        </div>
    </div>

    <div id="page4" class="hidden">
        <div class="pay-panel">
            <h2 class="pay-title">è§£é”æœªæ¥æŒ‡å¼•</h2>
            <div class="pay-price">Â¥2.99</div>
            <p class="pay-old-price">åŸä»· Â¥29.9</p>

            <div class="qr-row">
                <div class="qr-card">
                    <div class="qr-header-wx">æ¨èä½¿ç”¨å¾®ä¿¡æ”¯ä»˜</div>
                    <div class="qr-img-box"><img src="wechat_qrcode.jpg" alt="å¾®ä¿¡"></div>
                    <div class="qr-label">å¾®ä¿¡æ‰«ç </div>
                </div>
                <div class="qr-card">
                    <div class="qr-header-ali">æ¨èä½¿ç”¨æ”¯ä»˜å®</div>
                    <div class="qr-img-box"><img src="alipay_qrcode.png" alt="æ”¯ä»˜å®"></div>
                    <div class="qr-label">æ”¯ä»˜å®æ‰«ç </div>
                </div>
            </div>

            <div class="copy-area">
                <div class="copy-title">æ— æ³•æ‰«ç ï¼Ÿå¤åˆ¶è´¦å·è½¬è´¦ï¼š</div>
                <div class="copy-item">
                    <span>å¾®ä¿¡: hch91178</span>
                    <span class="copy-link" onclick="copyTxt('hch91178')">å¤åˆ¶</span>
                </div>
                <div class="copy-item">
                    <span>æ”¯ä»˜å®: 313360631@qq.com</span>
                    <span class="copy-link blue" onclick="copyTxt('313360631@qq.com')">å¤åˆ¶</span>
                </div>
            </div>

            <label class="btn-upload">
                ğŸ“· ä¸Šä¼ ä»˜æ¬¾æˆªå›¾ï¼Œè‡ªåŠ¨è§£é”
                <input type="file" accept="image/*" style="display:none" onchange="handleUpload(event)">
            </label>
        </div>
        
        <div class="footer-recruit-box">
            <div><span class="recruit-icon">ğŸ“¢</span> æ‹›è®¸æ„¿ç“¶é¡¹ç›®å­¦å¾’</div>
            <div class="recruit-link" onclick="copyTxt('HCH91178')">å¾®ä¿¡: HCH91178 (ç‚¹å‡»å¤åˆ¶)</div>
        </div>
    </div>

    <div id="page5" class="hidden">
        <div style="text-align:center; margin-bottom:20px;">
            <div style="font-size:40px;">âœ¨</div>
            <h2 style="color:#a5b4fc;">å®Œæ•´æŒ‡å¼•å·²è§£é”</h2>
        </div>

        <div class="final-card">
            <div class="result-section">
                <div class="res-title">ğŸ“… 2026å¹´å…³é”®è½¬æŠ˜ç‚¹</div>
                <div id="fullRes1" class="res-content"></div>
            </div>

            <div class="result-section">
                <div class="res-title">ğŸš§ é˜»ç¢ä½ çš„æœ€å¤§ç»Šè„šçŸ³</div>
                <div id="fullRes2" class="res-content"></div>
            </div>

            <div class="result-section">
                <div class="res-title">ğŸš€ å®‡å®™è¡ŒåŠ¨å»ºè®®</div>
                <div id="fullRes3" class="res-content"></div>
            </div>
        </div>

        <button class="btn-glow" style="background:#475569; box-shadow:none;" onclick="location.reload()">
            å†è®¸ä¸€ä¸ªæ„¿
        </button>

        <div class="footer-recruit-box">
            <div>ğŸ“¢ æ‹›è®¸æ„¿ç“¶é¡¹ç›®å­¦å¾’</div>
            <div class="recruit-link" onclick="copyTxt('HCH91178')">å¾®ä¿¡: HCH91178 (ç‚¹å‡»å¤åˆ¶)</div>
        </div>
    </div>

</div>

<script>
    const SERVER_KEY = "SCT303445TGU9j8Q5VLg6rT7eryLe8L41v"; 
    let userWishText = "";
    let detectedType = "general";

    // æ™ºèƒ½å›å¤åº“
    const templates = {
        money: {
            short: "æˆ‘å¬åˆ°äº†é‡‘å¸ç¢°æ’çš„å£°éŸ³ã€‚2026å¹´ä½ çš„è´¢å¸›å®«æœ‰åŠ¨é™ï¼Œæ›¾ç»çœ‹ä¼¼æ— ç”¨çš„æŠ•å…¥ï¼Œå°†åœ¨ç§‹å¤©è¿æ¥æƒŠäººçš„å›æŠ¥ã€‚",
            full1: "åœ¨2026å¹´çš„8æœˆ-9æœˆï¼Œä½ å°†è¿æ¥ä¸€æ¬¡é‡è¦çš„è´¢åŠ¡å¥‘æœºã€‚è¿™å¯èƒ½æºäºä¸€ä¸ªâ€˜æ—§è¯†â€™å¸¦æ¥çš„ä¿¡æ¯ï¼Œæˆ–è€…ä¸€é¡¹å‰¯ä¸šçš„çªç„¶çˆ†å‘ã€‚",
            full2: "æœ€å¤§çš„ç»Šè„šçŸ³æ˜¯â€˜æ€¥äºæ±‚æˆâ€™å’Œâ€˜è·Ÿé£â€™ã€‚å®‡å®™çš„èƒ½é‡é€šè¿‡ç§¯ç´¯è¿ä½œï¼Œåƒä¸‡ä¸è¦åœ¨é»æ˜å‰æ”¾å¼ƒï¼Œä¹Ÿä¸è¦è§¦ç¢°ä¸ç†Ÿæ‚‰çš„æŠ•æœºé¡¹ç›®ã€‚",
            full3: "å»ºç«‹ä¸€ä¸ªâ€˜è®¸æ„¿è´¦æˆ·â€™ï¼Œæ¯æœˆå­˜å…¥ä¸€ç¬”å›ºå®šèµ„é‡‘ä½œä¸ºç§å­ã€‚å¤šç©¿é‡‘è‰²æˆ–çº¢è‰²çš„é…é¥°ï¼Œèƒ½å¢å¼ºä½ çš„å¸é‡‘ç£åœºã€‚"
        },
        love: {
            short: "çº¢è‰²çš„ä¸çº¿æ­£åœ¨æ…¢æ…¢æ”¶ç´§ã€‚é‚£ä¸ªæ‡‚ä½ å¥‡å¥‡æ€ªæ€ªï¼Œä¹Ÿé™ªä½ å¯å¯çˆ±çˆ±çš„äººï¼Œæ­£åœ¨ç©¿è¶Šäººæµ·å‘ä½ èµ°æ¥ã€‚",
            full1: "2026å¹´çš„æ˜¥å­£ï¼ˆ3æœˆ-5æœˆï¼‰æ¡ƒèŠ±èƒ½é‡æœ€æ—ºã€‚åœ¨ä¸€æ¬¡éæ­£å¼çš„èšä¼šã€æ—…è¡Œæˆ–å­¦ä¹ åœºåˆä¸­ï¼Œä½ ä¼šé‡åˆ°ä»¤ä½ å¿ƒåŠ¨çš„äººã€‚",
            full2: "æœ€å¤§çš„ç»Šè„šçŸ³æ˜¯â€˜è¿‡å»çš„é˜´å½±â€™å’Œâ€˜è¿‡åº¦é˜²å¾¡â€™ã€‚ä½ æ½œæ„è¯†é‡Œçš„é˜²å¾¡æœºåˆ¶è®©ä½ åœ¨å…³ç³»æ¨è¿›æ—¶æƒ³è¦åé€€ã€‚è¯•ç€æ•å¼€å¿ƒæ‰‰ï¼Œè¿™ä¸€æ¬¡æ˜¯å®‰å…¨çš„ã€‚",
            full3: "æå‡è¡£å“ï¼Œå°è¯•æ¢ä¸€ä¸ªæ–°å‘å‹ã€‚æ¯å‘¨äº”æ™šä¸Šä¸è¦å®…åœ¨å®¶é‡Œï¼Œå¤šå»ä¹¦åº—ã€è‰ºæœ¯å±•æˆ–å…¬å›­ã€‚ä½ çš„æ­£ç¼˜æ˜¯ä¸€ä¸ªæ¸©æ–‡å°”é›…çš„äººã€‚"
        },
        career: {
            short: "æ˜Ÿç›˜æ˜¾ç¤ºä½ çš„â€˜å®˜ç¦„å®«â€™æ­£åœ¨é—ªè€€ã€‚ä¹‹å‰çš„è¿·èŒ«å°†å¦‚å¤§é›¾æ•£å»ï¼Œä¸€æ¡æ¸…æ™°çš„ä¸Šå‡é€šé“æ­£åœ¨ä¸ºä½ æ‰“å¼€ã€‚",
            full1: "å¹´ä¸­ï¼ˆ6æœˆï¼‰å°†æ˜¯ä½ çš„è½¬æŠ˜ç‚¹ã€‚ä¸€ä¸ªå›°æ‰°ä½ è®¸ä¹…çš„é¡¹ç›®æˆ–è€ƒè¯•å°†è¿åˆƒè€Œè§£ï¼Œä½ ä¼šå¾—åˆ°ä¸Šçº§æˆ–å¯¼å¸ˆçš„é«˜åº¦è®¤å¯ã€‚",
            full2: "ä½ æœ€å¤§çš„æ•Œäººæ˜¯â€˜æ‹–å»¶â€™å’Œâ€˜è‡ªæˆ‘æ€€ç–‘â€™ã€‚ä¸è¦ç­‰åˆ°å‡†å¤‡å¥½äº†å†å‡ºå‘ï¼Œç°åœ¨å°±æ˜¯æœ€å¥½çš„æ—¶æœºã€‚å°å¿ƒèº«è¾¹ä¸€ä¸ªå±â€˜ç«â€™çš„ç«äº‰è€…ã€‚",
            full3: "ä¿æŒä¸“æ³¨ï¼Œå‡å°‘æ— æ•ˆç¤¾äº¤ã€‚æŠŠåŠå…¬æ¡Œæˆ–ä¹¦æ¡Œæ•´ç†å¹²å‡€ï¼Œæ‘†æ”¾ä¸€ç›†å¸¸é’æ¤ç‰©ï¼Œæœ‰åŠ©äºç¨³å®šä½ çš„äº‹ä¸š/å­¦ä¸šç£åœºã€‚"
        },
        health: {
            short: "å®‡å®™æ„Ÿå—åˆ°äº†ä½ å¯¹å®‰å®çš„æ¸´æœ›ã€‚2026å¹´å°†æ˜¯â€˜ç–—æ„ˆâ€™çš„ä¸€å¹´ï¼Œæ—§çš„è´Ÿæ‹…å°†å¸ä¸‹ï¼Œèº«å¿ƒå°†é‡è·è½»ç›ˆã€‚",
            full1: "å…¥å†¬ï¼ˆ11æœˆï¼‰å‰åï¼Œä½ çš„èº«ä½“èƒ½é‡ä¼šè¾¾åˆ°ä¸€ä¸ªå°é«˜å³°ã€‚åˆ©ç”¨è¿™æ®µæ—¶é—´å…»æˆä¸€ä¸ªæ–°ä¹ æƒ¯ï¼ˆå¦‚ç‘œä¼½æˆ–æ™¨è·‘ï¼‰ï¼Œå°†å—ç›Šç»ˆèº«ã€‚",
            full2: "éœ€è¦è­¦æƒ•çš„æ˜¯â€˜æƒ…ç»ªå†…è€—â€™ã€‚èº«ä½“çš„å¾ˆå¤šä¸é€‚æºäºæœªè¡¨è¾¾çš„æƒ…ç»ªã€‚ä¸è¦ä¸ºäº†é¢å­è€Œå‹æŠ‘è‡ªå·±ï¼Œå­¦ä¼šæ‹’ç»ä¸èˆ’æœçš„è¯·æ±‚ã€‚",
            full3: "å¤šæ¥è§¦å¤§è‡ªç„¶ï¼Œæ£®æ—å’Œæµ·æ´‹èƒ½å¿«é€Ÿä¸ºä½ å……ç”µã€‚é¥®é£Ÿä¸Šå¤šæ‘„å…¥æ ¹èŒç±»é£Ÿç‰©ï¼Œå®ƒä»¬èƒ½å¢å¼ºä½ ä¸å¤§åœ°çš„è¿æ¥ï¼Œè®©ä½ æ›´ç¨³é‡ã€‚"
        },
        general: {
            short: "å®‡å®™æ¥æ”¶åˆ°äº†ä½ çš„ä¿¡å·ã€‚è™½ç„¶è¿™ä¸ªæ„¿æœ›æœ‰äº›ç‹¬ç‰¹ï¼Œä½†2026å¹´å¯¹ä½ è€Œè¨€æ˜¯â€˜é‡å¡‘â€™çš„ä¸€å¹´ï¼Œæ–°çš„ç¿…è†€æ­£åœ¨ç”Ÿé•¿ã€‚",
            full1: "ä¸‹åŠå¹´æ˜¯ä½ èƒ½é‡åœºçš„çˆ†å‘æœŸã€‚ä½ ä¼šæ„å¤–è·å¾—ä¸€ä¸ªå±•ç¤ºè‡ªæˆ‘çš„èˆå°ï¼Œè¯·åŠ¡å¿…æŠ“ä½è¿™æ¬¡æœºä¼šï¼Œä¸è¦é€€ç¼©ã€‚",
            full2: "é˜»ç¢ä½ çš„æ˜¯â€˜å¯¹æœªçŸ¥çš„ææƒ§â€™ã€‚ä½ ä¹ æƒ¯å¾…åœ¨èˆ’é€‚åŒºï¼Œä½†å¥‡è¿¹å¾€å¾€å‘ç”Ÿåœ¨èˆ’é€‚åŒºä¹‹å¤–ã€‚è¯•ç€åšä¸€ä»¶ä½ ä»æœªåšè¿‡çš„äº‹ã€‚",
            full3: "ä¿æŒæ¯å¤©è®°å½•ä¸‰ä»¶æ„Ÿæ©çš„å°äº‹ã€‚å¤šæ™’å¤ªé˜³ï¼Œä¿æŒæˆ¿é—´é€šé£ã€‚ä½ çš„å¹¸è¿è‰²æ˜¯ç™½è‰²å’Œè“è‰²ï¼Œå®ƒä»¬èƒ½å¸®ä½ ç†æ¸…æ€ç»ªã€‚"
        }
    };

    // é˜²ä¹±å¡«æ ¡éªŒ (ç™½åå•é€»è¾‘)
    function validateInput(text) {
        if (text.length < 2) return "ä¿¡å·å¤ªå¼±äº†ï¼Œè¯·å¤šå†™å‡ ä¸ªå­—æè¿°ä½ çš„æ„¿æœ›...";
        // å…è®¸æ±‰å­—ã€è‹±æ–‡
        if (!/[a-zA-Z\u4e00-\u9fa5]/.test(text)) return "å®‡å®™æ— æ³•è§£è¯»çº¯ç¬¦å·ä»£ç ï¼Œè¯·ç”¨æ–‡å­—å†™ä¸‹æ„¿æœ›ã€‚";
        if (/^(.)\1+$/.test(text)) return "è¯·çœŸè¯šåœ°å†™ä¸‹æ„¿æœ›ï¼Œä¸è¦å‘é€é‡å¤çš„ä¿¡å·å¹²æ‰°å®‡å®™ã€‚";
        return "OK";
    }

    function throwBottle() {
        const wish = document.getElementById('userWish').value.trim();
        const checkResult = validateInput(wish);
        
        if (checkResult !== "OK") {
            alert("ğŸ”® æç¤ºï¼š\n" + checkResult);
            return;
        }
        
        userWishText = wish;

        // æ™ºèƒ½åˆ†ç±»
        if (wish.match(/é’±|å¯Œ|è´¢|æš´|èµš|è–ª|è´·|é‡‘|ä¹°æˆ¿|è½¦/)) detectedType = 'money';
        else if (wish.match(/çˆ±|å©š|å¯¹è±¡|ç”·|å¥³|æ¡ƒèŠ±|ä¼´|æƒ…|è„±å•/)) detectedType = 'love';
        else if (wish.match(/å·¥|ä¸š|èŒ|å¹²|å‡|å­¦|è€ƒ|ç ”|åˆ†|æ¦œ|ä¸Šå²¸/)) detectedType = 'career';
        else if (wish.match(/ç—…|ç˜¦|ç¾|å¥|åº·|å®‰|å¯¿|è¯/)) detectedType = 'health';
        else detectedType = 'general';

        document.getElementById('page1').classList.add('hidden');
        document.getElementById('page2').classList.remove('hidden');

        setTimeout(() => {
            document.getElementById('page2').classList.add('hidden');
            document.getElementById('page3').classList.remove('hidden');
            generateResult();
        }, 3000);
    }

    function generateResult() {
        const tpl = templates[detectedType];
        document.getElementById('aiResponseText').innerText = tpl.short;
        const prob = Math.floor(Math.random() * (99 - 85 + 1)) + 85;
        document.getElementById('probVal').innerText = prob + "%";
        window.fullResultData = tpl;
    }

    function goToPay() {
        document.getElementById('page3').classList.add('hidden');
        document.getElementById('page4').classList.remove('hidden');
    }

    function handleUpload(e) {
        if(e.target.files.length === 0) return;
        document.querySelector('.btn-upload').innerHTML = 'â³ æ­£åœ¨è¿æ¥æœªæ¥...'; // ä¿®å¤æŒ‰é’®çŠ¶æ€

        fetch(`https://sctapi.ftqq.com/${SERVER_KEY}.send`, {
            method: 'POST', headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ title: 'ğŸ’°è®¸æ„¿ç“¶-æ–°è®¢å•2.99', desp: `æ„¿æœ›: ${userWishText}\nç±»å‹: ${detectedType}` })
        }).catch(()=>{});

        setTimeout(() => {
            alert("âœ… å®‡å®™èƒ½é‡è¿æ¥æˆåŠŸï¼å®Œæ•´æŒ‡å¼•å·²è§£é”ã€‚");
            showFullResult();
        }, 1500);
    }

    function showFullResult() {
        const tpl = window.fullResultData || templates.general;
        document.getElementById('page4').classList.add('hidden');
        document.getElementById('page5').classList.remove('hidden');
        document.getElementById('fullRes1').innerText = tpl.full1;
        document.getElementById('fullRes2').innerText = tpl.full2;
        document.getElementById('fullRes3').innerText = tpl.full3;
    }

    function copyTxt(t) {
        // å…¼å®¹æ€§å¤åˆ¶
        if (navigator.clipboard) {
            navigator.clipboard.writeText(t).then(() => alert('å¤åˆ¶æˆåŠŸ')).catch(() => fallbackCopy(t));
        } else {
            fallbackCopy(t);
        }
    }
    
    function fallbackCopy(t) {
        const input = document.createElement('textarea');
        input.value = t;
        document.body.appendChild(input);
        input.select();
        document.execCommand('copy');
        document.body.removeChild(input);
        alert('å¤åˆ¶æˆåŠŸ');
    }
</script>
</body>
</html>